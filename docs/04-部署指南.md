# 部署指南

## Vercel 部署

### 1. 准备代码
```bash
# 确保代码已提交到 Git
git add .
git commit -m "Ready for deployment"
git push origin main
```

### 2. Vercel 配置

#### 导入项目
1. 登录 [Vercel](https://vercel.com)
2. 点击 "Add New Project"
3. 导入 GitHub 仓库
4. 选择项目

#### 构建设置
- **Framework Preset**: Vite
- **Build Command**: `npm run build`
- **Output Directory**: `dist`

### 3. 环境变量

在 Vercel 项目设置中添加：

```
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key
VITE_MOONSHOT_API_KEY=your_moonshot_key
```

### 4. 部署
点击 "Deploy" 按钮，Vercel 会自动构建并部署。

## Supabase 配置

### 1. 创建项目
1. 登录 [Supabase](https://supabase.com)
2. 创建新项目
3. 设置数据库密码

### 2. 执行 SQL 脚本
在 SQL Editor 中依次执行：

```sql
-- 1. 基础结构
\i db_setup.sql

-- 2. 个人资料功能
\i db_profile_features.sql

-- 3. 模拟场景数据
\i db_simulation_complete.sql

-- 4. 演示数据（可选）
\i db_demo_data.sql
```

### 3. 配置 RLS 策略
RLS（Row Level Security）已包含在 SQL 脚本中，确保数据安全。

### 4. 获取连接信息
- 项目设置 → API
- 复制 `URL` 和 `anon public` API Key

## 域名配置（可选）

### 自定义域名
1. Vercel 项目设置 → Domains
2. 添加域名
3. 按照提示配置 DNS

### Supabase 自定义域名
1. Supabase 设置 → Custom Domains
2. 添加域名并验证

## 监控与维护

### Vercel Analytics
- 自动集成网站分析
- 查看访问量、性能指标

### Supabase 监控
- Database → Logs 查看查询日志
- Auth → Logs 查看认证日志

## 故障排除

### 构建失败
```bash
# 本地测试构建
npm run build

# 检查 TypeScript 错误
npx tsc --noEmit
```

### 数据库连接失败
- 检查环境变量是否正确
- 确认 Supabase 项目状态
- 检查 RLS 策略是否阻止访问

### API 调用失败
- 检查 CORS 设置
- 确认 API Key 权限
- 查看浏览器控制台错误
