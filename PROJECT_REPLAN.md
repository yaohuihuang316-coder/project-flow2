# ProjectFlow 重新规划方案

> 基于最新需求调整的项目计划
> 制定日期: 2026-02-17

---

## 🎯 新需求分析

### 需求1: AI智能出题与评估系统（高优先级）
**现状问题**: 
- 当前虽然有AI预加载题目的代码，但只是生成5道题
- 没有AI评估和给出改进建议的功能
- 用户完成模拟后，只是简单显示分数，缺少AI分析

**期望实现**:
1. 用户选择/输入一个项目场景（如"软件开发项目延期"、"团队冲突处理"等）
2. AI生成10道与该场景相关的选择题
3. 用户答题完成后，AI根据答题情况给出:
   - 总体能力评估
   - 知识薄弱点分析
   - 个性化改进建议
   - 推荐学习资源

### 需求2: 教师端完全自适应UI（高优先级）
**现状问题**:
- 虽然添加了侧边栏，但很多地方还有 `max-w-lg` 限制
- 模态框、卡片等组件没有适配桌面端
- 底部导航在桌面端应该隐藏，但实际可能还有问题

**期望实现**:
- 桌面端: 左侧固定侧边栏导航，右侧内容区自适应宽度
- 移动端: 底部导航栏
- 所有模态框在桌面端显示为居中弹窗，不是底部抽屉
- 表格、列表在桌面端显示更多列

### 需求3: 公告系统前后端打通（中优先级）
**现状问题**:
- 数据库表 `app_announcements` 已创建
- SQL已执行
- 但前端页面可能还没有连接真实数据
- 管理后台可能没有公告管理功能

**期望实现**:
- 学生端首页显示最新公告
- 教师端可以发布公告
- 管理后台可以管理所有公告
- 公告按角色推送（学生/教师/全部）

### 需求4: 教师端真实数据连接（高优先级）
**现状问题**:
- MyCourses、Classroom、Assignments 等页面使用 mock 数据
- 虽然创建了 Hooks，但页面还没有实际调用
- 数据增删改查都是本地状态，没有持久化

**期望实现**:
- 所有教师端页面连接 Supabase 真实数据
- 课程的增删改查
- 作业的发布、批改
- 课堂的创建、签到、投票
- 学生互动的真实数据

### 需求5: 后端教师管理功能（中优先级）
**现状问题**:
- 管理后台可能没有教师管理模块
- 无法查看教师列表、审核教师申请
- 无法管理教师的课程和权限

**期望实现**:
- 管理后台新增"教师管理"菜单
- 教师列表（查看、禁用、删除）
- 教师审核（待审核、已通过、已拒绝）
- 教师课程统计

---

## 📋 重新制定的实施计划

### Phase 1: AI智能出题与评估系统（Week 1）

#### 1.1 需求分析与Prompt设计
**时间**: 1天
**任务**:
- 设计AI出题的Prompt模板
- 设计AI评估的Prompt模板
- 定义题目数据结构
- 定义评估报告数据结构

**Prompt设计思路**:
```
出题Prompt:
"你是一个项目管理培训专家。请基于以下场景生成10道项目管理选择题：
场景: {userInput}
要求:
1. 每道题4个选项
2. 覆盖项目管理的不同知识领域
3. 难度适中，适合中级学习者
4. 返回JSON格式"

评估Prompt:
"基于用户的答题情况，给出详细的能力评估报告：
答题数据: {answers}
题目数据: {questions}
要求:
1. 总体评分（0-100）
2. 知识领域分析（规划、执行、风险管理等）
3. 薄弱点指出
4. 改进建议
5. 推荐学习资源"
```

#### 1.2 前端交互设计
**时间**: 2天
**任务**:
- 重新设计模拟演练入口页面
  - 场景选择（预设场景 + 自定义输入）
  - 难度选择
  - 开始按钮
- 答题页面优化
  - 进度显示
  - 题目导航
  - 计时功能
- 结果页面重新设计
  - AI评估报告展示
  - 能力雷达图
  - 改进建议列表
  - 推荐学习资源

#### 1.3 AI服务集成
**时间**: 2天
**任务**:
- 封装 `aiSimulationService.ts`
  - `generateQuestions(scene, difficulty, count)`
  - `evaluateAnswers(answers, questions)`
- 错误处理和重试机制
- 结果缓存策略

#### 1.4 数据存储
**时间**: 1天
**任务**:
- 创建 `app_simulation_sessions` 表（存储每次模拟记录）
- 创建 `app_simulation_answers` 表（存储答题详情）
- 创建 `app_ai_evaluations` 表（存储AI评估结果）
- RLS策略配置

---

### Phase 2: 教师端完全自适应UI（Week 1-2）

#### 2.1 布局系统重构
**时间**: 2天
**任务**:
- 创建统一的 `TeacherLayout` 组件
  - 桌面端: 侧边栏 + 内容区
  - 移动端: 内容区 + 底部导航
- 所有教师页面使用统一布局
- 响应式断点定义:
  - `sm`: 640px (手机)
  - `md`: 768px (平板)
  - `lg`: 1024px (桌面)
  - `xl`: 1280px (大屏)

#### 2.2 组件适配
**时间**: 3天
**任务**:
| 组件 | 桌面端 | 移动端 |
|------|--------|--------|
| Modal | 居中显示，宽度限制 max-w-2xl | 底部抽屉，全宽 |
| Card | 网格布局，一行2-3个 | 单列堆叠 |
| Table | 完整列显示 | 卡片式简化显示 |
| Form | 多列并排 | 单列堆叠 |
| BottomNav | 隐藏 | 显示 |
| Sidebar | 显示 | 隐藏 |

#### 2.3 页面逐个修复
**时间**: 2天
**任务**:
- MyCourses.tsx: 课程卡片网格、模态框适配
- Classroom.tsx: 白板区域、工具栏适配
- Assignments.tsx: 作业列表、批改界面适配
- Interactions.tsx: 讨论列表、回复框适配
- Profile.tsx: 个人信息卡片适配

---

### Phase 3: 公告系统前后端打通（Week 2）

#### 3.1 数据库确认
**时间**: 0.5天
**任务**:
- 确认 `app_announcements` 表结构
- 确认是否有示例数据
- 确认RLS策略是否正确

#### 3.2 前端公告展示
**时间**: 1.5天
**任务**:
- 学生端 Dashboard 公告轮播/列表
- 公告详情页
- 公告分类筛选（系统/课程/活动）

#### 3.3 教师端公告发布
**时间**: 1天
**任务**:
- 公告发布表单
- 富文本编辑器（或Markdown）
- 目标受众选择（全部/学生/教师）
- 有效期设置

#### 3.4 管理后台公告管理
**时间**: 1天
**任务**:
- 公告列表（管理）
- 公告编辑/删除
- 公告置顶
- 发布状态管理（草稿/已发布/已下架）

---

### Phase 4: 教师端真实数据连接（Week 2-3）

#### 4.1 课程管理（MyCourses）
**时间**: 2天
**任务**:
- 读取真实课程列表
- 创建课程（保存到数据库）
- 编辑课程
- 删除/归档课程
- 课程统计（学生数、完成率等）

#### 4.2 课堂管理（Classroom）
**时间**: 2天
**任务**:
- 创建课堂会话
- 开始/结束上课
- 学生签到实时更新
- 投票创建和结果统计
- 学生提问接收和回复
- 白板数据保存

#### 4.3 作业管理（Assignments）
**时间**: 2天
**任务**:
- 发布作业（关联课程）
- 作业列表（真实数据）
- 学生提交查看
- 批改作业（打分、评语）
- 作业统计

#### 4.4 学生互动（Interactions）
**时间**: 1天
**任务**:
- Q&A列表（真实数据）
- 回复问题
- 讨论区主题列表
- 通知管理

---

### Phase 5: 后端教师管理功能（Week 3）

#### 5.1 教师列表
**时间**: 1天
**任务**:
- 管理后台新增"教师管理"菜单
- 教师列表页面
- 筛选（全部/待审核/已通过/已拒绝）
- 搜索功能

#### 5.2 教师审核
**时间**: 1天
**任务**:
- 教师详情页
- 审核操作（通过/拒绝）
- 审核理由填写
- 通知教师审核结果

#### 5.3 教师数据统计
**时间**: 1天
**任务**:
- 教师课程数量统计
- 教师学生数量统计
- 教师活跃度统计
- 数据可视化图表

---

## ⏰ 时间规划表

| 阶段 | 内容 | 预计时间 | 优先级 |
|------|------|----------|--------|
| Phase 1 | AI智能出题与评估 | 1周 | P0 |
| Phase 2 | 教师端完全自适应UI | 1周 | P0 |
| Phase 3 | 公告系统打通 | 0.5周 | P1 |
| Phase 4 | 教师端真实数据 | 1周 | P0 |
| Phase 5 | 后端教师管理 | 0.5周 | P1 |

**总计**: 约4周工作量

---

## 🎯 优先级说明

### P0 - 必须完成（影响核心体验）
1. **AI智能出题与评估** - 这是产品的核心差异化功能
2. **教师端完全自适应UI** - 影响教师使用体验
3. **教师端真实数据** - 基础功能必须可用

### P1 - 重要功能（提升完整性）
4. **公告系统打通** - 信息传达重要渠道
5. **后端教师管理** - 运营管理必要功能

---

## ❓ 需要确认的问题

1. **AI出题的场景来源**:
   - 方式A: 提供10个预设场景让用户选择
   - 方式B: 用户自由输入任何场景描述
   - 方式C: 两者结合（预设+自定义）

2. **AI评估的详细程度**:
   - 简单版: 总分 + 简短评价
   - 详细版: 分维度评分 + 详细建议 + 推荐资源

3. **教师管理权限**:
   - 谁能审核教师？只有SuperAdmin？还是Manager也可以？

4. **公告发布权限**:
   - 只有管理员能发？还是教师也能发（仅限自己的课程）？

---

## 📝 交付物清单

### 代码文件
- [ ] `services/aiSimulationService.ts` - AI服务封装
- [ ] `components/teacher/TeacherLayout.tsx` - 统一布局组件
- [ ] `pages/teacher/AISimulation.tsx` - AI模拟演练页面（新）
- [ ] `pages/admin/TeacherManagement.tsx` - 教师管理页面（新）
- [ ] `pages/admin/AnnouncementManagement.tsx` - 公告管理页面（新/完善）
- [ ] 修改现有的5个教师端页面

### 数据库
- [ ] `app_simulation_sessions` 表
- [ ] `app_simulation_answers` 表
- [ ] `app_ai_evaluations` 表
- [ ] 更新 `app_announcements` 相关策略

### 文档
- [ ] AI Prompt设计文档
- [ ] 教师端UI设计规范
- [ ] 数据库表结构文档

---

**请确认以上计划后，我将按阶段开始实施。**
