-- ==========================================
-- 公告示例数据种子脚本
-- ProjectFlow 项目管理学习平台
-- ==========================================

-- 清空现有公告数据（可选，取消注释以启用）
-- TRUNCATE TABLE app_announcements RESTART IDENTITY;

-- 插入示例公告数据
INSERT INTO app_announcements (title, content, type, priority, target_audience, is_active, start_at, end_at) VALUES

-- ==========================================
-- 1. 系统公告（2条）
-- ==========================================

(
    '欢迎使用 ProjectFlow 项目管理学习平台！',
    '亲爱的用户，欢迎加入 ProjectFlow！在这里您可以：\n• 学习专业的项目管理课程\n• 使用强大的项目管理工具\n• 参与社区讨论与经验分享\n• 体验实战模拟场景\n\n祝您学习愉快，技能精进！如有任何问题，请联系我们的客服团队。',
    'success',
    10,
    'all',
    true,
    NOW(),
    NOW() + INTERVAL '30 days'
),

(
    '系统功能更新：全新仪表盘上线',
    '我们很高兴地宣布，全新的个人仪表盘功能已正式上线！\n\n本次更新内容包括：\n• 个性化学习进度展示\n• 项目完成度可视化图表\n• 快捷操作入口优化\n• 学习数据深度分析\n\n点击右上角头像进入「个人中心」即可体验全新功能。',
    'info',
    8,
    'all',
    true,
    NOW(),
    NOW() + INTERVAL '14 days'
),

-- ==========================================
-- 2. 课程公告（3条）
-- ==========================================

(
    'PMP 认证新课程已上线，快来学习吧！',
    '备受期待的《PMP 认证完整指南》课程现已正式上线！\n\n课程亮点：\n• 35小时专业PDU学时\n• 覆盖全部考试知识领域\n• 配套练习题库1000+\n• 资深PMP讲师在线答疑\n\n会员用户可免费学习全部内容，立即点击课程页面开始学习吧！',
    'success',
    9,
    'students',
    true,
    NOW(),
    NOW() + INTERVAL '60 days'
),

(
    '敏捷项目管理实战课程更新通知',
    '《敏捷项目管理实战》课程已完成内容升级！\n\n更新内容：\n• 新增Scrum框架深度解析章节\n• 增加5个真实企业案例\n• 补充看板(Kanban)实战演练\n• 新增DevOps与敏捷结合模块\n\n已报名的学员可直接免费学习更新内容。',
    'info',
    7,
    'students',
    true,
    NOW(),
    NOW() + INTERVAL '21 days'
),

(
    '教师专属：课程创作工具升级',
    '各位讲师，课程创作工作台已进行全面升级！\n\n新功能包括：\n• 富文本编辑器增强，支持更多格式\n• 视频章节自动分割功能\n• 作业批改批量处理\n• 学员学习数据导出\n\n登录讲师后台即可体验新功能，如有建议请随时反馈。',
    'info',
    6,
    'teachers',
    true,
    NOW(),
    NOW() + INTERVAL '30 days'
),

-- ==========================================
-- 3. 活动公告（2条）
-- ==========================================

(
    '【直播预告】项目管理大咖分享会 - 第3期',
    '直播主题：《从初级PM到项目总监的成长之路》\n\n直播时间：本周六晚 20:00-21:30\n\n分享嘉宾：李明 - 某互联网大厂项目总监，15年项目管理经验\n\n内容大纲：\n• 项目管理职业发展路径\n• 关键能力跃升技巧\n• 面试与晋升经验分享\n• 互动答疑环节\n\n点击预约直播，开播前将发送提醒通知！',
    'warning',
    9,
    'all',
    true,
    NOW(),
    NOW() + INTERVAL '5 days'
),

(
    '「30天项目管理挑战赛」开始报名！',
    '想要快速提升项目管理实战能力？加入我们的30天挑战赛吧！\n\n活动形式：\n• 每日学习任务打卡\n• 真实项目案例分析\n• 团队协作模拟练习\n• 导师点评与指导\n\n活动时间：下月1日-30日\n报名截止：本月28日\n\n完成挑战可获得：\n✓ 官方认证证书\n✓ 精美周边礼品\n✓ Pro会员体验月卡\n\n名额有限，立即报名！',
    'success',
    8,
    'students',
    true,
    NOW(),
    NOW() + INTERVAL '20 days'
);

-- ==========================================
-- 查询验证
-- ==========================================

-- 查看所有公告统计
SELECT 
    type,
    COUNT(*) as count,
    STRING_AGG(title, ' | ' ORDER BY priority DESC) as titles
FROM app_announcements 
WHERE is_active = true 
GROUP BY type;

-- 按优先级查看公告
SELECT 
    title,
    type,
    priority,
    target_audience,
    start_at,
    end_at
FROM app_announcements 
ORDER BY priority DESC, created_at DESC;
